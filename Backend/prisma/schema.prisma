generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model StatusAgendamento {
  id          Int           @id @default(autoincrement())
  descricao   String
  cor         String
  agendamento Agendamento[]

  @@map("status_agendamento")
}

model CargoPermissoes {
  cargoId     Int
  permissaoId Int
  cargo       Cargo     @relation(fields: [cargoId], references: [id], onDelete: Cascade, map: "FK_57b474c85ecbfcd6cc421f46e81")
  permissao   Permissao @relation(fields: [permissaoId], references: [id], onDelete: Cascade, map: "FK_cee926c9f8446750c17f7d6356")

  @@id([cargoId, permissaoId])
  @@index([cargoId], map: "IDX_57b474c85ecbfcd6cc421f46e8")
  @@index([permissaoId], map: "IDX_cee926c9f8446750c17f7d6356")
  @@map("cargo_permissoes")
}

model Ferias {
  id             Int         @id @default(autoincrement())
  descricao      String      @db.VarChar(255)
  data_inicio    DateTime    @db.Date
  data_fim       DateTime    @db.Date
  colaborador_id Int
  created_at     DateTime?   @default(now()) @db.DateTime(0)
  colaborador    Colaborador @relation(fields: [colaborador_id], references: [id], map: "fk_ferias_colaborador")

  @@index([colaborador_id], map: "fk_ferias_colaborador")
  @@map("ferias")
}

model Agendamento {
  id                 Int               @id @default(autoincrement())
  id_utente          Int
  id_servicos        Int
  id_colaborador     Int
  atualizado_em      DateTime
  criado_em          DateTime          @default(now())
  data_agendamento   DateTime
  hora_fim           DateTime?
  hora_inicio        DateTime
  observacoes        String?
  statusId           Int
  status_agendamento StatusAgendamento @relation(fields: [statusId], references: [id], map: "Agendamento_statusId_fkey")
  colaborador        Colaborador       @relation(fields: [id_colaborador], references: [id], map: "FK_Agendamento_Colaborador")
  servico            Servico           @relation(fields: [id_servicos], references: [id], map: "FK_Agendamento_Servico")
  utente             Utente            @relation(fields: [id_utente], references: [id], map: "FK_Agendamento_Utente")

  @@index([statusId], map: "Agendamento_statusId_fkey")
  @@index([id_colaborador], map: "FK_Agendamento_Colaborador")
  @@index([id_servicos], map: "FK_Agendamento_Servico")
  @@index([id_utente], map: "FK_Agendamento_Utente")
}

model Cargo {
  id          Int               @id @default(autoincrement())
  descricao   String            @db.VarChar(255)
  permissoes  CargoPermissoes[]
  colaborador Colaborador[]
}

model Colaborador {
  id              Int                @id @default(autoincrement())
  cargoId         Int?
  descricao       String             @db.VarChar(255)
  email           String             @unique(map: "IDX_2c7cab1392c28313e5880d941b") @db.VarChar(255)
  telemovel       String             @db.VarChar(255)
  senha           String             @db.VarChar(255)
  imagem_url      String?            @db.VarChar(255)
  cor             String?            @db.VarChar(22)
  agendamento     Agendamento[]
  cargo           Cargo?             @relation(fields: [cargoId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_084fb63ed0f5810c87764c3987c")
  disponibilidade Disponibilidade[]
  Ferias          Ferias[]

  @@index([cargoId], map: "FK_084fb63ed0f5810c87764c3987c")
}

model Disponibilidade {
  id             Int         @id @default(autoincrement())
  id_colaborador Int
  dia_da_semana  Int         @db.TinyInt
  hora_inicio    DateTime    @db.Time(0)
  hora_fim       DateTime    @db.Time(0)
  colaborador    Colaborador @relation(fields: [id_colaborador], references: [id], map: "Disponibilidade_id_colaborador_fkey")

  @@index([id_colaborador], map: "Disponibilidade_id_colaborador_fkey")
}

model Permissao {
  id        Int               @id @default(autoincrement())
  descricao String            @db.VarChar(255)
  cargos    CargoPermissoes[]
}

model Servico {
  id          Int           @id @default(autoincrement())
  descricao   String        @db.VarChar(45)
  valor       Decimal       @db.Decimal(10, 2)
  duracao     Float
  agendamento Agendamento[]
}

model Utente {
  id            Int           @id @default(autoincrement())
  nome          String
  email         String
  telemovel     String?
  distrito      String?
  pais          String?
  codigo_postal String?
  concelho      String?
  morada        String?
  agendamento   Agendamento[]
}
